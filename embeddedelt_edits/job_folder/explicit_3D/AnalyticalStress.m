clear; clc;
mu=76.92e9; lam=115.4e9;
K=lam+(2*mu/3);
F=[0.9883 0 0; 0 1.04 0; 0 0 0.9883]
b=F*F'
J=det(F)
I1=trace(b)
LE=log(F)
sigma = J^(-5/3)*mu*(b-(1/3)*I1*eye(3)) + K*(J-1)*eye(3)

J^(-5/3)*mu*(b-(1/3)*I1*eye(3))
K*(J-1)*eye(3)


sig = (1/J)*((lam*log(J)-mu)*eye(3)+mu*b);

% p = [1 0.1 0.5]; 
% x = [1,1,0,0,1,1,0,0;0,1,1,0,0,1,1,0;0,0,0,0,1,1,1,1];
x=[1  1  1; 1 0 1;1  1  0 ;1  0  0;0  1  1;0  0  1;0  1  0 ;0  0  0]'; 
%For testing
%         F=[1 0 0; 0 1 0; 0 0 1];
%         F=[2 0 0.6; 0 4 0; 0.6 0 1.5];
%         F=[2 -.1 -0.6; -.0 .5 0; -0.6 0 1.7];
%         x=x-2;

        xn = zeros(3,8);
        for i=1:8
           xn(:,i) = F*x(:,i); 
        end
        x=xn